<!DOCTYPE html>
<html>
<head>
    <title>PAMS - Barcelona Academy Program</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: Arial, sans-serif; margin: 0; background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%); min-height: 100vh; padding: 20px; color: #00ffff; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { background: linear-gradient(135deg, rgba(0,255,255,0.1), rgba(255,0,255,0.1)); border: 2px solid #00ffff; color: #00ffff; padding: 25px; border-radius: 20px; margin-bottom: 25px; text-align: center; box-shadow: 0 0 30px rgba(0,255,255,0.3); }
        .program-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-bottom: 25px; }
        .program-card { background: linear-gradient(135deg, rgba(0,255,255,0.05), rgba(255,0,255,0.05)); border: 1px solid #00ffff; padding: 25px; border-radius: 15px; box-shadow: 0 0 15px rgba(0,255,255,0.2); }
        .card-title { color: #00ffff; font-size: 20px; font-weight: bold; margin-bottom: 15px; }
        .training-day { background: linear-gradient(135deg, rgba(0,255,255,0.1), rgba(255,0,255,0.1)); padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #ff00ff; }
        .drill-list { list-style: none; padding: 0; }
        .drill-list li { background: rgba(0,255,255,0.1); padding: 8px 12px; margin: 5px 0; border-radius: 4px; color: #cccccc; }
        .skill-assessment { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0; }
        .skill-category { text-align: center; }
        .skill-meter { width: 100%; height: 20px; background: rgba(0,0,0,0.5); border-radius: 10px; overflow: hidden; margin: 10px 0; }
        .skill-fill { height: 100%; background: linear-gradient(90deg, #ff0000, #ff9900, #00ff00); border-radius: 10px; transition: width 1s ease; }
        .btn { padding: 12px 20px; border: none; border-radius: 25px; font-weight: bold; cursor: pointer; text-decoration: none; display: inline-block; background: linear-gradient(135deg, #00ffff, #0080ff); color: #000; margin: 5px; box-shadow: 0 0 20px rgba(0,255,255,0.3); transition: all 0.3s ease; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 0 30px rgba(0,255,255,0.5); background: linear-gradient(135deg, #ff00ff, #ff0080); }
        .philosophy-box { background: linear-gradient(135deg, rgba(0,255,255,0.1), rgba(255,0,255,0.1)); border: 1px solid #00ffff; color: #00ffff; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .age-selector { display: flex; gap: 10px; margin: 15px 0; justify-content: center; }
        .age-btn { padding: 8px 16px; border: 2px solid #00ffff; background: rgba(0,0,0,0.5); color: #00ffff; border-radius: 6px; cursor: pointer; }
        .age-btn.active { background: #00ffff; color: #000; }
        h1, h2, h3, h4 { color: #00ffff; text-shadow: 0 0 10px rgba(0,255,255,0.3); }
        p, small { color: #cccccc; }
    </style>

</head>
<body>
    <div class="container">
        <div class="header">
            <div class="barca-logo">üîµüî¥</div>
            <h1>FC Barcelona Academy Program</h1>
            <p>"M√©s que un club" - More than a club</p>
            <p>La Masia methodology for young players</p>
        </div>

        <div class="philosophy-box">
            <h3>üèÜ Barcelona Philosophy</h3>
            <p><strong>Possession-based football:</strong> Keep the ball, play with intelligence, and always look for the pass.</p>
            <p><strong>Technical excellence:</strong> Perfect your first touch, passing accuracy, and ball control.</p>
            <p><strong>Tactical intelligence:</strong> Understand space, timing, and decision-making.</p>
            <p><strong>Mental strength:</strong> Play with confidence, creativity, and never give up.</p>
        </div>

        <div style="text-align: center;">
            <h3>Select Your Age Group</h3>
            <div class="age-selector">
                <button class="age-btn" onclick="loadProgram(8)">8-10 years</button>
                <button class="age-btn active" onclick="loadProgram(12)">11-14 years</button>
                <button class="age-btn" onclick="loadProgram(16)">15-18 years</button>
            </div>
        </div>

        <div class="program-grid">
            <div class="program-card">
                <div class="card-title">üìÖ Weekly Training Plan</div>
                <div id="weeklyPlan">Loading...</div>
            </div>

            <div class="program-card">
                <div class="card-title">üéØ Key Development Areas</div>
                <div id="keySkills">Loading...</div>
            </div>

            <div class="program-card">
                <div class="card-title">‚öΩ Signature Drills</div>
                <div id="signatureDrills">
                    <div class="drill-list">
                        <li><strong>Rondo 4v2:</strong> Keep possession in tight space</li>
                        <li><strong>Tiki-Taka Passing:</strong> Quick, short passes</li>
                        <li><strong>La Pausa:</strong> Pause before receiving the ball</li>
                        <li><strong>Positional Play:</strong> Understand your role</li>
                        <li><strong>1v1 Finishing:</strong> Beat the keeper</li>
                    </div>
                </div>
            </div>
        </div>

        <div class="program-card">
            <div class="card-title">üìä Skill Assessment - Barcelona Style</div>
            <div class="skill-assessment">
                <div class="skill-category">
                    <h4>Technical</h4>
                    <div>Ball Control</div>
                    <div class="skill-meter"><div class="skill-fill" style="width: 0%" id="ball-control"></div></div>
                    <div>Passing</div>
                    <div class="skill-meter"><div class="skill-fill" style="width: 0%" id="passing"></div></div>
                    <div>Dribbling</div>
                    <div class="skill-meter"><div class="skill-fill" style="width: 0%" id="dribbling"></div></div>
                </div>
                <div class="skill-category">
                    <h4>Physical</h4>
                    <div>Speed</div>
                    <div class="skill-meter"><div class="skill-fill" style="width: 0%" id="speed"></div></div>
                    <div>Agility</div>
                    <div class="skill-meter"><div class="skill-fill" style="width: 0%" id="agility"></div></div>
                    <div>Endurance</div>
                    <div class="skill-meter"><div class="skill-fill" style="width: 0%" id="endurance"></div></div>
                </div>
                <div class="skill-category">
                    <h4>Mental</h4>
                    <div>Decision Making</div>
                    <div class="skill-meter"><div class="skill-fill" style="width: 0%" id="decision-making"></div></div>
                    <div>Game Intelligence</div>
                    <div class="skill-meter"><div class="skill-fill" style="width: 0%" id="game-intelligence"></div></div>
                    <div>Composure</div>
                    <div class="skill-meter"><div class="skill-fill" style="width: 0%" id="composure"></div></div>
                </div>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-success" onclick="openSkillAssessment()">üìù Complete Skill Assessment</button>
            </div>
        </div>

        <div style="text-align: center; margin-top: 25px;">
            <a href="/soccer-training" class="btn btn-barca">‚öΩ Log Training Session</a>
            <a href="/parent" class="btn btn-success">‚Üê Back to Dashboard</a>
        </div>
    </div>

    <!-- Skill Assessment Modal -->
    <div id="assessmentModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000;">
        <div style="background: white; margin: 50px auto; padding: 30px; border-radius: 10px; max-width: 600px; max-height: 80vh; overflow-y: auto;">
            <h3>Barcelona Style Skill Assessment</h3>
            <form id="skillAssessmentForm">
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                    <div>
                        <h4>Technical Skills (1-10)</h4>
                        <label>Ball Control: <input type="range" min="1" max="10" value="5" id="ballControl"></label>
                        <label>Passing: <input type="range" min="1" max="10" value="5" id="passingSkill"></label>
                        <label>Shooting: <input type="range" min="1" max="10" value="5" id="shooting"></label>
                        <label>Dribbling: <input type="range" min="1" max="10" value="5" id="dribblingSkill"></label>
                        <label>Heading: <input type="range" min="1" max="10" value="5" id="heading"></label>
                    </div>
                    <div>
                        <h4>Physical Attributes (1-10)</h4>
                        <label>Speed: <input type="range" min="1" max="10" value="5" id="speedAttr"></label>
                        <label>Agility: <input type="range" min="1" max="10" value="5" id="agilityAttr"></label>
                        <label>Strength: <input type="range" min="1" max="10" value="5" id="strength"></label>
                        <label>Endurance: <input type="range" min="1" max="10" value="5" id="enduranceAttr"></label>
                    </div>
                    <div>
                        <h4>Mental Aspects (1-10)</h4>
                        <label>Decision Making: <input type="range" min="1" max="10" value="5" id="decisionMaking"></label>
                        <label>Game Intelligence: <input type="range" min="1" max="10" value="5" id="gameIntelligence"></label>
                        <label>Leadership: <input type="range" min="1" max="10" value="5" id="leadership"></label>
                        <label>Composure: <input type="range" min="1" max="10" value="5" id="composureSkill"></label>
                    </div>
                </div>
                <div style="margin-top: 20px;">
                    <label>Assessment Notes:</label>
                    <textarea id="assessmentNotes" rows="3" style="width: 100%; padding: 8px;" placeholder="Areas for improvement, strengths, goals..."></textarea>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn btn-success">Save Assessment</button>
                    <button type="button" class="btn" style="background: #95a5a6;" onclick="closeAssessment()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let currentAge = 12;

        async function loadProgram(age) {
            currentAge = age;
            document.querySelectorAll('.age-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            try {
                const response = await fetch('/api/barca-program');
                const program = await response.json();

                // Weekly Plan
                const planHtml = Object.entries(program.weekly_plan).map(([day, session]) => `
                    <div class="training-day">
                        <strong>${day}</strong> - ${session.type}<br>
                        <small>Focus: ${session.focus}</small><br>
                        <small>Drills: ${session.drills.join(', ')}</small>
                    </div>
                `).join('');
                document.getElementById('weeklyPlan').innerHTML = planHtml;

                // Key Skills
                const skillsHtml = `
                    <div style="text-align: center; margin-bottom: 15px;">
                        <strong>Focus: ${program.focus}</strong><br>
                        <small>${program.sessions_per_week} sessions/week ‚Ä¢ ${program.session_duration} min each</small>
                    </div>
                    ${program.key_skills.map(skill => `<div class="drill-list"><li>${skill}</li></div>`).join('')}
                `;
                document.getElementById('keySkills').innerHTML = skillsHtml;

            } catch (error) {
                console.error('Error loading program:', error);
            }
        }

        function openSkillAssessment() {
            document.getElementById('assessmentModal').style.display = 'block';
        }

        function closeAssessment() {
            document.getElementById('assessmentModal').style.display = 'none';
        }

        document.getElementById('skillAssessmentForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = {
                ball_control: document.getElementById('ballControl').value,
                passing: document.getElementById('passingSkill').value,
                shooting: document.getElementById('shooting').value,
                dribbling: document.getElementById('dribblingSkill').value,
                heading: document.getElementById('heading').value,
                speed: document.getElementById('speedAttr').value,
                agility: document.getElementById('agilityAttr').value,
                strength: document.getElementById('strength').value,
                endurance: document.getElementById('enduranceAttr').value,
                decision_making: document.getElementById('decisionMaking').value,
                game_intelligence: document.getElementById('gameIntelligence').value,
                leadership: document.getElementById('leadership').value,
                composure: document.getElementById('composureSkill').value,
                notes: document.getElementById('assessmentNotes').value,
                assessor: 'Self-Assessment'
            };

            try {
                const response = await fetch('/api/skill-assessment', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    alert('‚úÖ Skill assessment saved successfully!');
                    closeAssessment();
                    updateSkillMeters(formData);
                } else {
                    alert('‚ùå Failed to save assessment. Please try again.');
                }
            } catch (error) {
                alert('‚ùå Error saving assessment. Please try again.');
            }
        });

        function updateSkillMeters(data) {
            document.getElementById('ball-control').style.width = (data.ball_control * 10) + '%';
            document.getElementById('passing').style.width = (data.passing * 10) + '%';
            document.getElementById('dribbling').style.width = (data.dribbling * 10) + '%';
            document.getElementById('speed').style.width = (data.speed * 10) + '%';
            document.getElementById('agility').style.width = (data.agility * 10) + '%';
            document.getElementById('endurance').style.width = (data.endurance * 10) + '%';
            document.getElementById('decision-making').style.width = (data.decision_making * 10) + '%';
            document.getElementById('game-intelligence').style.width = (data.game_intelligence * 10) + '%';
            document.getElementById('composure').style.width = (data.composure * 10) + '%';
        }

        // Load default program
        loadProgram(12);
    </script>
</body>
</html>